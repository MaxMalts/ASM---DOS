Turbo Assembler	 Version 4.1	    03/28/20 23:49:18	    Page 1
s_func01.asm



      1				     locals @@
      2
      3	0000			     .model tiny
      4
      5				     public Memchr, Memcmp, Memset, Memcpy, Strlen, Strchr, Strcpy, Strcmp
      6
      7	0000			     .code
      8
      9				     ; Searches	for the	first byte equal to input.
     10				     ; Input:	     es	- memory segment
     11				     ;		     di	- address of the first byte of the memory block
     12				     ;		     al	- value	to search
     13				     ;		     cx	- size of memory block
     14				     ; Output:	     di	- address of the first equal byte, 0 if	not found
     15				     ; Destroy:	     cx
     16	0000			     Memchr proc
     17	0000  F2> AE			     repne scasb
     18	0002  4F			     dec di
     19
     20	0003  26: 38 05			     cmp es:[di], al
     21	0006  74 03			     je	@@Found
     22	0008  BF 0000			     mov di, 0
     23
     24	000B				     @@Found:
     25	000B  C3			     ret
     26	000C				     Memchr endp
     27
     28				     ; Compares	two memory blocks
     29				     ; Input:	     ds	- first	memory segment
     30				     ;		     si	- first	block address
     31				     ;		     es	- second memory	segment
     32				     ;		     di	- second block address
     33				     ;		     cx	- blocks size
     34				     ; Output:	     The result	in flags as it would "cmp" do
     35				     ; Destroy:	     si, di, cx
     36	000C			     Memcmp proc
     37	000C  F3> A6			     repe cmpsb
     38
     39	000E  C3			     ret
     40	000F				     Memcmp endp
     41
     42
     43				     ; Fills a memory block
     44				     ; Input:	     es	- memory segment
     45				     ;		     di	- block	address
     46				     ;		     al	- value
     47				     ;		     cx	- blocks size
     48				     ; Destroy:	     di, cx
     49	000F			     Memset proc
     50	000F  F3> AA			     rep stosb
     51
     52	0011  C3			     ret
     53	0012				     Memset endp
     54
     55
     56				     ; Copies block of memory
     57				     ; Input:	     ds	- source memory	segment
Turbo Assembler	 Version 4.1	    03/28/20 23:49:18	    Page 2
s_func01.asm



     58				     ;		     si	- source block address
     59				     ;		     es	- destination memory segment
     60				     ;		     di	- destination block address
     61				     ;		     cx	- blocks size
     62				     ; Destroy:	     si, di, cx
     63	0012			     Memcpy proc
     64	0012  F3> A4			     repe movsb
     65
     66	0014  C3			     ret
     67	0015				     Memcpy endp
     68
     69
     70				     ; Calculates the length of	string
     71				     ; Input:	     es	- memory segment
     72				     ;		     di	- string address (max length 0ffffH)
     73				     ; Output:	     ax	- length
     74				     ; Destroy:	     di, cx, al
     75	0015			     Strlen proc
     76	0015  B0 24			     mov al, '$'
     77	0017  B9 FFFF			     mov cx, 0ffffH
     78
     79	001A  F2> AE			     repne scasb
     80
     81	001C  B8 FFFE			     mov ax, 0fffeH
     82	001F  2B C1			     sub ax, cx
     83
     84	0021  C3			     ret
     85	0022				     Strlen endp
     86
     87				     ; Searches	for first character entry in string
     88				     ; Input:	     es	- memory segment
     89				     ;		     di	- string address (max length 0ffffH)
     90				     ;		     al	- character
     91				     ; Output:	     di	- address of found character, 0	if not found
     92	0022			     Strchr proc
     93	0022				     @@Func_loop:
     94	0022  80 3D 24				     cmp byte ptr[di], '$'
     95	0025  74 07				     je	@@Not_found
     96	0027  38 05				     cmp [di], al
     97	0029  74 06				     je	@@Found
     98
     99	002B  47				     inc di
    100	002C  EB F4				     jmp @@Func_loop
    101
    102	002E				     @@Not_found:
    103	002E  BF 0000			     mov di, 0
    104	0031				     @@Found:
    105
    106	0031  C3			     ret
    107	0032				     Strchr endp
    108
    109				     ; Copies string
    110				     ; Input:	     ds	- source memory	segment
    111				     ;		     si	- source string	address
    112				     ;		     es	- destination memory segment
    113				     ;		     di	- destination string address
    114				     ; Destroy:	     si, di
Turbo Assembler	 Version 4.1	    03/28/20 23:49:18	    Page 3
s_func01.asm



    115	0032			     Strcpy proc
    116	0032				     @@Func_loop:
    117	0032  80 3C 24				     cmp byte ptr ds:[si], '$'
    118	0035  A4				     movsb
    119
    120	0036  74 02				     je	@@End_func
    121	0038  EB F8				     jmp @@Func_loop
    122
    123	003A				     @@End_func:
    124	003A  C3			     ret
    125	003B				     Strcpy endp
    126
    127
    128				     ; Compares	two strings
    129				     ; Input:	     ds	- first	memory segment
    130				     ;		     si	- first	string address
    131				     ;		     es	- second memory	segment
    132				     ;		     di	- second string	address
    133				     ; Output:	     The result	in flags as it would "cmp" do
    134				     ; Destroy:	     si, di, cx
    135
    136	003B			     Strcmp proc
    137	003B				     @@Func_loop:
    138	003B  80 3C 24				     cmp byte ptr ds:[si], '$'
    139	003E  75 10				     jne @@If_FirstNotEnded
    140	0040  26: 80 3D	24				     cmp byte ptr es:[di], '$'
    141	0044  75 03					     jne @@If_SecondNotEnded_1
    142	0046  EB 1A 90						     jmp @@End_Func
    143	0049						     @@If_SecondNotEnded_1:
    144	0049  26: 80 3D	25					     cmp byte ptr es:[di], '$'+1D
    145	004D  EB 13 90						     jmp @@End_func
    146	0050					     @@If_FirstNotEnded:
    147	0050  26: 80 3D	24				     cmp byte ptr es:[di], '$'
    148	0054  75 07					     jne @@If_SecondNotEnded_2
    149	0056  26: 80 3D	23					     cmp byte ptr es:[di], '$'-1
    150	005A  EB 06 90						     jmp @@End_func
    151	005D						     @@If_SecondNotEnded_2:
    152	005D  A6						     cmpsb
    153	005E  75 02						     jne @@End_func
    154	0060  EB D9				     jmp @@Func_loop
    155
    156	0062				     @@End_func:
    157	0062  C3			     ret
    158	0063				     Strcmp endp
    159				     end
Turbo Assembler	 Version 4.1	    03/28/20 23:49:18	    Page 4
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/28/20"
??FILENAME			  Text	 "s_func01"
??TIME				  Text	 "23:49:18"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@END_FUNC			  Near	 DGROUP:003A
@@END_FUNC			  Near	 DGROUP:0062
@@FOUND				  Near	 DGROUP:000B
@@FOUND				  Near	 DGROUP:0031
@@FUNC_LOOP			  Near	 DGROUP:0022
@@FUNC_LOOP			  Near	 DGROUP:0032
@@FUNC_LOOP			  Near	 DGROUP:003B
@@IF_FIRSTNOTENDED		  Near	 DGROUP:0050
@@IF_SECONDNOTENDED_1		  Near	 DGROUP:0049
@@IF_SECONDNOTENDED_2		  Near	 DGROUP:005D
@@NOT_FOUND			  Near	 DGROUP:002E
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 S_FUNC01
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
MEMCHR				  Near	 DGROUP:0000
MEMCMP				  Near	 DGROUP:000C
MEMCPY				  Near	 DGROUP:0012
MEMSET				  Near	 DGROUP:000F
STRCHR				  Near	 DGROUP:0022
STRCMP				  Near	 DGROUP:003B
STRCPY				  Near	 DGROUP:0032
STRLEN				  Near	 DGROUP:0015

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0063 Word	  Public  CODE
